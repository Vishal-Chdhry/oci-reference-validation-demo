package main

import "testing"

func Test_ORAS(t *testing.T) {
	certificate := `-----BEGIN CERTIFICATE-----
MIIDVzCCAj+gAwIBAgICAL8wDQYJKoZIhvcNAQELBQAwWjELMAkGA1UEBhMCVVMx
CzAJBgNVBAgTAldBMRAwDgYDVQQHEwdTZWF0dGxlMQ8wDQYDVQQKEwZOb3Rhcnkx
GzAZBgNVBAMTEndhYmJpdC1uZXR3b3Jrcy5pbzAeFw0yMzA0MTkwODE0MjBaFw0y
NDA0MTkwODE0MjBaMFoxCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJXQTEQMA4GA1UE
BxMHU2VhdHRsZTEPMA0GA1UEChMGTm90YXJ5MRswGQYDVQQDExJ3YWJiaXQtbmV0
d29ya3MuaW8wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCsLni/3fDd
MUKwzfSkc8orPrCLCRoiampqeBIQNlKZGP5UL7BP6neav/oy8p09b1ArBwKh1coO
LBLZh2BPVmNyoSmq8Ip9md7OQi5ApaC0cys/GTmJQov/tmFq+o9GOdK6yVjX8bS/
NPrlaM5XCzY9WaTvW/ODu7MjVqBFGHQa9AFjEJZrxtPkOF0WV7ffPiQ5RZnuccK0
V0ycKCtsadXFdQZl2w/Li5DZHTVyc6mhtIyPBSlsIbpQXB5SLPVb7jsDKk/XoNd6
DwB6lYBKgUtNL1cFhjwdWaTrqy5ymiuMKjyeeileZinpQH129jfTjL6Rx8Tv7PMf
Cu0hfgOMQ5TPAgMBAAGjJzAlMA4GA1UdDwEB/wQEAwIHgDATBgNVHSUEDDAKBggr
BgEFBQcDAzANBgkqhkiG9w0BAQsFAAOCAQEARnay50VbglZqudCIbsp96HHHkf+p
lvRkFOo148UaeeN12k803yRx2PxYzmUHvNKjX76eAWT3KzQEG9FRId5mSr2gO8sp
JJs9WITfKAXnNGSz/rd8tN6eSUKgN+32A9reKPO+0ntN1dJDb8R9892ze88UpDva
wgFXsl+jKC0y4HSEeHufIqgyI6freRFvUEAAMJ0SKPfNROc/1WcW5F4u6Sbh2UNn
lXOXSo6yg2xRJxATkHc9PE7tSBnDRIwjJG3ZyRLdyTeuzOl95ARImUtPAn2ElODf
21yAXY47fCnTSkTw1ZrSQa6jWG7Er/mgsTVT98PcKIGyx3iqPFNJjUkj/Q==
-----END CERTIFICATE------`

	repo_name := "jimnotarytest.azurecr.io/jim/net-monitor:v1"

	artifact_type := "vuln-scan"
	ORAS(repo_name, certificate, artifact_type)
}

func Test_Regclient(t *testing.T) {
	certificate := `-----BEGIN CERTIFICATE-----
MIIDSjCCAjKgAwIBAgIBazANBgkqhkiG9w0BAQsFADBUMQswCQYDVQQGEwJVUzEL
MAkGA1UECBMCV0ExEDAOBgNVBAcTB1NlYXR0bGUxDzANBgNVBAoTBk5vdGFyeTEV
MBMGA1UEAxMMcmVnY3RsLTItYXByMB4XDTIzMDQwMjEzNTcyMloXDTIzMDQwMzEz
NTcyMlowVDELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAldBMRAwDgYDVQQHEwdTZWF0
dGxlMQ8wDQYDVQQKEwZOb3RhcnkxFTATBgNVBAMTDHJlZ2N0bC0yLWFwcjCCASIw
DQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKeHmgiolF3oi4WaUay3Tb5IRJXc
+YGtKo2SYXSAot3XBOPzZG16FAn4adSL7bvcB4IX1kVSp8+XCig6ylKNUnEDMsut
E0KLDlInDZUsIgXuKu+ErXG82xF3v07+aThPBV0XmeEz83Mu73eX0fvFzaoGGJbT
XCYwmjufLPyX2c0zGcLTHHMfApq9gc7J6n/cF4oWF3g05TI7H9vTntoOsbX1i2A6
jujpnJbpXu57QuJflNfyaR0pqYvRMRZzlqHxYFx/RqkAr+rHSPv3k1KKHxKJlqhl
rC5sOmoNrevdplH7WpFkRCPRZjdf3pX9Tll8w1jGWXYsS38IgFs6FgMjjrUCAwEA
AaMnMCUwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQMMAoGCCsGAQUFBwMDMA0GCSqG
SIb3DQEBCwUAA4IBAQAOWqPC1Gve6svaDZUvC1iPnB+TblHY9sUC3J9PsiLJYLQd
irRwQrNuhiVuPLPn9QI7vfU2X4TdITr0LQeqrk0T86mYMJ67YIzqzHGss3svIfif
PvAywk41bWIdDO7e0sR6kvijXfJWjT/QOi0m53b4l8Mrn7WnaatqXcwwLZk0VGky
A51EXlotz9kCDrP04vS8AtzcTT7BZ+2xNGF3MuerLx7buJCeIHsSxLxAOFFt5ZI0
8SpeYaX0d6mBGL50EW+TzCD/fVjlzdLD4x1BMRLDU3nnLolh47+/7W95PBv0FmPb
nzICwOuaH2VDTmW0kSl6KRN7vD6iXRxgFon9DbGO
-----END CERTIFICATE-----`

	repo_name := "localhost:5000/lachie/net-monitor:v1"

	artifact_type := "application/vnd.cyclonedx+json"
	Regclient(repo_name, certificate, artifact_type)
}

func Test_Flux(t *testing.T) {
	certificate := `-----BEGIN CERTIFICATE-----
MIIDSjCCAjKgAwIBAgIBazANBgkqhkiG9w0BAQsFADBUMQswCQYDVQQGEwJVUzEL
MAkGA1UECBMCV0ExEDAOBgNVBAcTB1NlYXR0bGUxDzANBgNVBAoTBk5vdGFyeTEV
MBMGA1UEAxMMcmVnY3RsLTItYXByMB4XDTIzMDQwMjEzNTcyMloXDTIzMDQwMzEz
NTcyMlowVDELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAldBMRAwDgYDVQQHEwdTZWF0
dGxlMQ8wDQYDVQQKEwZOb3RhcnkxFTATBgNVBAMTDHJlZ2N0bC0yLWFwcjCCASIw
DQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAKeHmgiolF3oi4WaUay3Tb5IRJXc
+YGtKo2SYXSAot3XBOPzZG16FAn4adSL7bvcB4IX1kVSp8+XCig6ylKNUnEDMsut
E0KLDlInDZUsIgXuKu+ErXG82xF3v07+aThPBV0XmeEz83Mu73eX0fvFzaoGGJbT
XCYwmjufLPyX2c0zGcLTHHMfApq9gc7J6n/cF4oWF3g05TI7H9vTntoOsbX1i2A6
jujpnJbpXu57QuJflNfyaR0pqYvRMRZzlqHxYFx/RqkAr+rHSPv3k1KKHxKJlqhl
rC5sOmoNrevdplH7WpFkRCPRZjdf3pX9Tll8w1jGWXYsS38IgFs6FgMjjrUCAwEA
AaMnMCUwDgYDVR0PAQH/BAQDAgeAMBMGA1UdJQQMMAoGCCsGAQUFBwMDMA0GCSqG
SIb3DQEBCwUAA4IBAQAOWqPC1Gve6svaDZUvC1iPnB+TblHY9sUC3J9PsiLJYLQd
irRwQrNuhiVuPLPn9QI7vfU2X4TdITr0LQeqrk0T86mYMJ67YIzqzHGss3svIfif
PvAywk41bWIdDO7e0sR6kvijXfJWjT/QOi0m53b4l8Mrn7WnaatqXcwwLZk0VGky
A51EXlotz9kCDrP04vS8AtzcTT7BZ+2xNGF3MuerLx7buJCeIHsSxLxAOFFt5ZI0
8SpeYaX0d6mBGL50EW+TzCD/fVjlzdLD4x1BMRLDU3nnLolh47+/7W95PBv0FmPb
nzICwOuaH2VDTmW0kSl6KRN7vD6iXRxgFon9DbGO
-----END CERTIFICATE-----`

	repo_name := "jimnotarytest.azurecr.io/jim/net-monitor"

	artifact_type := "application/vnd.cyclonedx+json"
	Flux(repo_name, certificate, artifact_type)
}

func Test_ACR_Regclient(t *testing.T) {
	ACRRegclient()
}

func Test_GCRCrane(t *testing.T) {
	GCRCrane()
}
